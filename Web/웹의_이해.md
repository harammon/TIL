# 웹 프로그래밍

### 1.  웹프로그래밍이란?

- HTTP(S) 프로토콜로 통신하는 클라이언트와 서버를 개발하는 것이다.

- 웹 클라이언트(주로 브라우저)가 **요청**하고, 웹 서버가 **응답**하는 **클라리언트-서버 프로그램**

   

### 2. 다양한 웹 클라이언트

- 웹 서버에 요청을 보내는 웹 클라이언트는 웹 브라우저 이외에도 다양하게 만들 수 있다.

1. 웹 브라우저를 사용하여 요청
2. 리눅스 `curl`명령을 사용하여 요청
3.  Telnet을 사용하여 요청
4. 직접 만든 클라이언트로 요청

   -> 웹 클라이언트의 형태는 달라도, 동일한 요청에 대해 동일한 응답을 받는다.



### 3. HTTP 프로토콜

- HTTP`(Hypertext Transfer Protocol)`는 웹 서버와 웹 클라이언트 사이에서 데이터를 주고받기 위해 사용하는 통신 방식으로, **TCP/IP** 프로토콜 위에서 동작한다.

  -> 즉, 웹을 이용하려면 웹 서버와 웹 클라이언트는 각각 TCP/IP 동작에 필수적인 **IP 주소**를 가져야 한다는 것을 의미한다.

- HTTP란 이름대로라면 하이퍼텍스트 전송용 프로토콜이지만, 실제로는 HTML이나, XML과 같은 하이퍼텍스트뿐만 아니라, 이미지, 음성, 동영상, 자바스크립트, 각종 오피스 도큐먼트 파일 등 컴퓨터에서 다룰 수 있는 데이터라면 무엇이든 전송 가능하다.



#### 3-1. HTTP 메시지의 구조

- 스타트라인 / 헤더 / 빈 줄 / 바디로 구성
- 스타트라인은 요청 메시지일 때 **요청 라인**이라 하고, 응답 메시지일 때 **상태 라인**이라고 한다.
  - 요청 라인 : 요청 방식 / 요청 URL / 프로토콜 버전으로 구성
  - 상태 라인 : 프로토콜 버전 / 상태 코드 / 상태 텍스트로 구성

- 헤더 : **이름:값** 형식으로 표현

- 헤더와 바디는 **빈 줄**로 구분한다.
- 바디 : 텍스트뿐만 아니라 바이너리 데이터도 들어갈수 있다(보통 HTML 텍스트).

-> *헤더와 바디는 생략 가능!*



#### 3-2. HTTP 처리 방식

- **HTTP 메소드**를 통해 클라이언트가 원하는 처리 방식을 서버에 알려준다.
- HTTP 메소드

| 메소드 명 | 의미                             | CRUD와 매핑되는 역할 | 비고                                                 |
| --------- | -------------------------------- | -------------------- | ---------------------------------------------------- |
| GET       | 리소스 취득                      | Read(조회)           | 서버로 부터 웹 페이지, 이미지, 동영상 등을 가져올 때 |
| POST      | 리소스 생성, 데이터 추가         | Create(생성)         | 블로그에 글을 등록하는 경우                          |
| PUT       | 리소스 변경                      | Update(변경)         | 블로그 글의 작성자 변경, 글의 내용 업데이트하는 경우 |
| DELETE    | 리소스 삭제                      | Delete(삭제)         | 일반적으로 DELETE 요청에 대한 응답은 바디를 반환 X   |
| HEAD      | 리소스의 헤더(메타데이터) 취득   |                      |                                                      |
| OPTIONS   | 리소스가 서포트하는 메소드 취득  |                      |                                                      |
| TRACE     | 루프백 시험에 사용               |                      |                                                      |
| CONNECT   | 프록시 동작의 터널 접속으로 변경 |                      |                                                      |

-> *PUT 메소드도 리소스를 생성하는 데 사용 가능하긴 함.*



#### 3-3. GET과 POST 메소드

- 현실적으로 가장 많이 사용하는 메소드는 **GET** 과 **POST**.

**GET**

~~~ 
GET https://www.youtube.com/watch?v=msEyXbAtFys HTTP/1.1
~~~

-> URL 부분의 `?` 뒤에 **이름=값** 쌍으로 이어붙여 보낸다.

**POST**

~~~
POST https://www.youtube.com/watch HTTP/1.1
Content-Type: application/x-www-form-urlencoded

q=?v=msEyXbAtFys
~~~

-> GET에서 URL에 포함시켰던 파라미터들을 요청 메시지의 **바디**에 넣는다.

- 이처럼 파라미터를 보내는 방식의 차이로 GET방식을 이용하면, 많은 양의 데이터를 보내기 어렵다. (URL은 길이 제한이 있기 때문)

- 또한, 전달되는 사용자의 데이터가 웹 브라우저의 주소창에 노출된다는 단점 존재.

  -> 따라서, 폼을 사용하거나, 추가적인 파라미터를 서버로 보내는 경우에는 GET보다 **POST** 방식을 많이 사용하는데, **장고** 프레임워크에서도 폼의 데이터는 POST 방식만을 사용하고 있다.



#### 3-4. 상태 코드

- **세자리 숫자**로 구성
  - 첫 번째 숫자 : HTTP 응답의 종류를 구분
  - 나머지 숫자 : 세부적인 응답 내용의 구분

| 메소드 명 | 의미                     | 비고                                                         |
| --------- | ------------------------ | ------------------------------------------------------------ |
| 1xx       | Informational(정보 제공) | 임시적인 응답으로, 현재 클라이언트의 요청까지 처리되었으니 계속 진행하라는 의미 |
| 2xx       | Success(성공)            | 클라이언트의 요청이 서버에서 성공적으로 처리되었다는 의미    |
| 3xx       | Redirection(리다이렉션)  | 완전한 처리를 위해서 추가적인 동작을 필요로 하는 경우        |
| 4xx       | Client Error             | 없는 페이지를 요청하는 것처럼 클라이언트의 요청 메시지 내용이 잘못된 경우 |
| 5xx       | Server Error             | 서버 측 사정에 의해서 메시지 처리에 문제가 발생한 경우       |



### 4. URL 설계

- URL 설계는 웹 서버 로직 설계의 첫걸음

- 사용자 또는 웹 클라이언트에게 웹 서버가 가지고 있는 기능을 명시해주는 중요한 단계

- 전체 프로그램 로직을 생각하며, 차후 로직이 변경되더라도, URL 변경은 **최소화**할 수 있도록 유연한 설계 필요

- RPC 방식 / REST 방식

- **간편 URL** 등장 : 쿼리스트링 없이 경로만 가진 간단한 구조의 URL

  -> 파이썬 프레임워크 도입(우아한 URL)



### 5. 웹 애플리케이션 서버(WAS)

- 초창기 웹은 웹 서버가 정적인 페이지를 보여주는 것이 주된 역할이었음

- 그러나, 동적 페이지에 대한 요구가 생기고, 데이터베이스 처리에 대한 요구가 많아짐에 따라 웹 서버와는 다른 별도의 프로그램의 필요성 증대

  -> CGI 규격 정의

- **웹 서버** : 정적 페이지인 HTML, 이미지, CSS, 자바스크립트 파일 제공

- **웹 애플리케이션 서버** : 웹 서버로부터 **동적 페이지 요청**을 받아서 요청을 처리하고 그 결과를 **웹 서버로 반환**

  -> 주로 동적 페이지 생성을 위한 프로그램 실행과, 데이터베이스 연동 기능을 처리

  

#### 5-1. CGI 방식의 단점

- CGI 규격 : **별도의 프로그램**(C, Perl, PHP 프로그램 등)과 웹 서버 사이에 정보를 주고받는 규칙을 정의한 것
- 각각의 클라이언트 요청에 대해 독립적인 별도의 프로세스가 생성 -> 시스템 부하



#### 5-2. 대안 기술

1. 별도의 애플리케이션을 **스크립트 언어**로 작성하고, 스크립트 엔진(인터프리터)을 웹 서버에 내장시켜 별도의 프로세스를 기동시키는 오버헤드를 줄이는 방식

2. 애플리케이션을 처리하는 프로세스를 미리 데몬으로 기동시켜 놓은 후, 웹 서버의 요청을 데몬에서 처리하는 방식

   -> 기술이 점차 발전함에 따라 애플리케이션 전용 데몬인 **WAS 방식**으로 발전. 

   ​    JSP`(Java Server Page)` , ASP`(Active Server Page)` 기술에서 WAS 방식 사용



#### 5-3. WAS 방식

- 웹 서버가 직접 프로그램을 호출하기보다는, WAS를 통해 간접적으로 웹 애플리케이션 프로그램을 실행한다.
- WAS는 프로그램 실행 결과를 웹 서버에 전달해주며, 웹 서버는 응답 결과를 웹 클라이언트에 전송한다. 

- 웹 서버와 WAS가 분리됨에 따라, 서로의 역할도 구분하여 사용하는 것이 좋다.